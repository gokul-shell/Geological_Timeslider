System.register(["jimu-core"],(function(t,e){var o={};return{setters:[function(t){o.AbstractDataAction=t.AbstractDataAction,o.DataLevel=t.DataLevel,o.DataSourceStatus=t.DataSourceStatus,o.MutableStoreManager=t.MutableStoreManager,o.getAppStore=t.getAppStore}],execute:function(){t((()=>{"use strict";var t={48891:t=>{t.exports=o}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,n),r.exports}n.d=(t,e)=>{for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var i={};return(()=>{n.r(i),n.d(i,{default:()=>o});var t=n(48891),e=function(t,e,o,n){return new(o||(o=Promise))((function(i,r){function a(t){try{l(n.next(t))}catch(t){r(t)}}function u(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(a,u)}l((n=n.apply(t,e||[])).next())}))};class o extends t.AbstractDataAction{isSupported(o,n){var i,r,a,u,l,d,c,v,s,p,f,g;return e(this,void 0,void 0,(function*(){if(o.length>1)return!1;const e=o[0],S=e.dataSource,y=function(){var e,o,n;return window.jimuConfig.isBuilder?null===(o=null===(e=(0,t.getAppStore)().getState())||void 0===e?void 0:e.appStateInBuilder)||void 0===o?void 0:o.appConfig:null===(n=(0,t.getAppStore)().getState())||void 0===n?void 0:n.appConfig}(),h=null===(i=null==y?void 0:y.widgets)||void 0===i?void 0:i[this.widgetId],b=null===(r=h.config)||void 0===r?void 0:r.configInfo;if(!b||0===Object.keys(b).length)return!1;let A=null===(d=null===(l=null===(a=null==y?void 0:y.widgets)||void 0===a?void 0:a[null===(u=h.useMapWidgetIds)||void 0===u?void 0:u[0]])||void 0===l?void 0:l.config)||void 0===d?void 0:d.initialMapDataSourceID;A||(A=Object.keys(b)[0]);const D=null===(v=null===(c=h.config)||void 0===c?void 0:c.configInfo)||void 0===v?void 0:v[A];return!!(null===(s=h.config)||void 0===s?void 0:s.useMapWidget)&&((null===(f=null===(p=null==D?void 0:D.analysisSettings)||void 0===p?void 0:p.layersInfo)||void 0===f?void 0:f.length)>0&&(!(null===(g=null==D?void 0:D.searchSettings)||void 0===g?void 0:g.searchByActiveMapArea)&&(!(!S||S.getStatus()===t.DataSourceStatus.NotReady)&&(!(!(null==S?void 0:S.supportSpatialInfo)||!(null==S?void 0:S.supportSpatialInfo()))&&n===t.DataLevel.Records&&e.records.length>0&&n===t.DataLevel.Records&&("current"===e.type||"selected"===e.type)))))}))}onExecute(o){return e(this,void 0,void 0,(function*(){const e=o[0],{records:n}=e;if((null==n?void 0:n.length)>0){const e={};return n.forEach((t=>{var o;const n=null===(o=null==t?void 0:t.dataSource)||void 0===o?void 0:o.id;e[n]||(e[n]=[]),e[n].push(t.feature.geometry)})),t.MutableStoreManager.getInstance().updateStateValue(this.widgetId,"selectedIncidentLocation",e),!0}}))}}})(),i})())}}}));